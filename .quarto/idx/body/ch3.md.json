{"title":"第3章 线性回归","markdown":{"headingText":"第3章 线性回归","containsRefs":false,"markdown":"\n## 1. 线性回归简介\n\n线性回归是一种用于预测**定量响应变量**的监督学习方法。它历史悠久、应用广泛，并且是理解许多高级统计学习方法的基础。\n\n本章旨在回答以下核心问题：\n* 广告投入与产品销量之间是否存在关系？\n* 这种关系的强度如何？\n* 哪些广告媒体（如电视、广播、报纸）对销量有显著影响？\n* 如何准确预测未来的销量？\n* 预测变量与响应变量之间的关系是线性的吗？\n* 不同广告媒体之间是否存在**协同效应**（即交互作用）？\n\n---\n\n## 2. 简单线性回归\n\n简单线性回归使用**单个预测变量 X** 来预测**定量响应变量 Y**。\n\n### 模型\n其数学模型假设 X 和 Y 之间存在近似的线性关系：\n$$ Y \\approx \\beta_0 + \\beta_1 X $$\n-   **$\\beta_0$**：截距 (intercept)\n-   **$\\beta_1$**：斜率 (slope)\n-   $\\beta_0$ 和 $\\beta_1$ 统称为**模型系数** (model coefficients) 或**参数** (parameters)。\n\n### 系数估计\n最常用的估计方法是**最小二乘法 (least squares)**。该方法旨在最小化**残差平方和 (Residual Sum of Squares, RSS)**。\n$$ RSS = \\sum_{i=1}^{n} (y_i - \\hat{y}_i)^2 = \\sum_{i=1}^{n} (y_i - (\\hat{\\beta}_0 + \\hat{\\beta}_1 x_i))^2 $$\n通过微积分可以求得使 RSS 最小化的估计值：\n$$ \\hat{\\beta}_1 = \\frac{\\sum_{i=1}^{n}(x_i - \\bar{x})(y_i - \\bar{y})}{\\sum_{i=1}^{n}(x_i - \\bar{x})^2} $$\n$$ \\hat{\\beta}_0 = \\bar{y} - \\hat{\\beta}_1 \\bar{x} $$\n\n### 评估系数的准确性\n-   **标准误 (Standard Error, SE)**：衡量系数估计值 $\\hat{\\beta}$ 的不确定性。SE 越小，估计越准确。\n-   **置信区间 (Confidence Intervals)**：提供一个参数真实值的可能范围。例如，一个95%的置信区间意味着该区间有95%的概率包含参数的真实值。\n-   **假设检验 (Hypothesis Testing)**：\n    -   **原假设 $H_0$**：X 和 Y 之间没有关系，即 $\\beta_1 = 0$。\n    -   **备择假设 $H_a$**：X 和 Y 之间存在关系，即 $\\beta_1 \\neq 0$。\n    -   **t-统计量**：衡量 $\\hat{\\beta}_1$ 偏离0的标准差倍数。$t = (\\hat{\\beta}_1 - 0) / SE(\\hat{\\beta}_1)$。\n    -   **p-值**：在 $H_0$ 为真的情况下，观测到当前或更极端结果的概率。p值越小，拒绝 $H_0$ 的证据越强。\n\n### 评估模型的准确性\n-   **残差标准误 (Residual Standard Error, RSE)**：衡量模型对数据拟合的**缺失程度**，代表响应值偏离真实回归线的平均距离。\n-   **R² 统计量**：衡量响应变量 Y 的总变异中，能够被预测变量 X 解释的**比例**。其值介于0和1之间，越接近1表示模型解释能力越强。在简单线性回归中，$R^2 = r^2$ (相关系数的平方)。\n\n---\n\n## 3. 多元线性回归\n\n多元线性回归使用**多个预测变量** ($X_1, X_2, \\dots, X_p$) 来预测 Y。\n\n### 模型\n$$ Y = \\beta_0 + \\beta_1 X_1 + \\beta_2 X_2 + \\dots + \\beta_p X_p + \\epsilon $$\n-   $\\beta_j$ 的解释是：在**保持其他所有预测变量不变**的情况下，$X_j$ 每增加一个单位，Y 的平均变化量。\n\n### 核心问题\n1.  **是否存在关系？**\n    -   使用 **F-统计量** 来检验**所有**预测变量的系数是否同时为零 ($H_0: \\beta_1 = \\beta_2 = \\dots = \\beta_p = 0$)。F-统计量远大于1且对应的p值很小，则表明至少有一个预测变量与响应相关。\n\n2.  **哪些变量是重要的？(变量选择)**\n    -   由于检查所有 $2^p$ 个可能的模型不现实，通常采用自动化方法：\n        -   **前向选择 (Forward selection)**：从空模型开始，逐个添加最显著的变量。\n        -   **后向选择 (Backward selection)**：从包含所有变量的模型开始，逐个移除最不显著的变量。\n        -   **混合选择 (Mixed selection)**：结合以上两种方法。\n\n3.  **模型拟合得如何？**\n    -   同样使用 RSE 和 R²。但需注意，向模型中添加变量**总会**使训练集上的 R² 增加，即使该变量与响应无关。\n\n4.  **预测的准确性**\n    -   **置信区间**：用于量化**平均响应**的不确定性。\n    -   **预测区间**：用于量化**单个响应**的不确定性。预测区间总是比置信区间宽，因为它包含了不可约误差 $\\epsilon$。\n\n---\n\n## 4. 回归模型的其他注意事项\n\n### 定性预测变量\n-   对于只有两个水平的定性变量，可以创建一个 **(0, 1) 虚拟变量 (dummy variable)**。\n-   对于超过两个水平的定性变量，需要创建 **k-1 个**虚拟变量，其中 k 是水平的数量。未分配虚拟变量的水平称为**基线 (baseline)**。\n\n### 线性模型的扩展\n1.  **交互作用 (Interaction Terms)**\n    -   放宽**可加性假设** (即预测变量的影响是独立的)。\n    -   通过在模型中添加两个预测变量的乘积项 ($X_1 \\times X_2$) 来实现。\n    -   一个显著的交互项表明，一个预测变量对响应的影响依赖于另一个预测变量的水平。这在市场营销中被称为**协同效应 (synergy effect)**。\n\n2.  **非线性关系 (Polynomial Regression)**\n    -   放宽**线性假设**。\n    -   通过在模型中添加预测变量的多项式项 (如 $X^2, X^3$) 来拟合曲线关系。\n    -   这本质上仍然是一个线性模型，因为它对变换后的变量是线性的。\n\n### 潜在问题\n1.  **非线性**：通过**残差图** (residuals vs. fitted values) 发现。若残差图呈现明显模式 (如U形)，则表明存在非线性。\n2.  **误差项相关**：常见于时间序列数据。这会导致标准误被低估，使得置信区间过窄，p值过小。\n3.  **异方差性 (Heteroscedasticity)**：误差项方差非恒定。在残差图中表现为**漏斗形状**。可通过对响应变量进行变换 (如 `log(Y)`) 来解决。\n4.  **异常值 (Outliers)**：响应值 $y_i$ 远离模型预测值的点。\n5.  **高杠杆点 (High-Leverage Points)**：预测值 $x_i$ 不寻常的点。这些点对回归线有很大影响。\n6.  **共线性 (Collinearity)**：两个或多个预测变量高度相关。\n    -   这会使系数估计变得不稳定，标准误增大。\n    -   可通过**方差膨胀因子 (Variance Inflation Factor, VIF)** 检测。VIF > 5 或 10 表明存在问题。\n    -   解决方法：移除一个相关变量或将它们组合成一个新变量。\n\n---\n\n## 5. 线性回归与 K-最近邻 (KNN) 的比较\n\n| 特性         | 线性回归                                              | K-最近邻 (KNN)                                              |\n| :----------- | :---------------------------------------------------- | :---------------------------------------------------------- |\n| **方法类型** | **参数化 (Parametric)**：对函数形式 (线性) 做出假设。 | **非参数化 (Non-parametric)**：不对函数形式做假设，更灵活。 |\n| **适用场景** | 当真实关系接近线性时，表现优异。                      | 当真实关系为非线性时，可能表现更好。                        |\n| **可解释性** | 高。模型由几个系数定义，易于理解。                    | 低。没有简单的模型或系数可供解释。                          |\n| **维度影响** | 在高维情况下表现相对稳健。                            | 在高维情况下性能急剧下降 (即**维度灾难**)。                 |\n\n**结论**：\n-   如果预测准确性是首要目标，且真实关系可能是非线性的，KNN值得考虑。\n-   如果可解释性很重要，或者预测变量维度很高而样本量不大，线性回归通常是更好的选择。","srcMarkdownNoYaml":""},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":false,"code-overflow":"wrap","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":true,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"toc-depth":3,"number-sections":false,"highlight-style":"atom-one","css":["../styles.css"],"output-file":"ch3.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.8.23","editor":"visual","theme":"cosmo","linestretch":1.6,"fontsize":"11.5pt","highlight":true,"callout-appearance":"default","md-extensions":["callout"]},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}