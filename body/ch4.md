# 第4章 分类 (Classification) 

### 核心概念
- **分类 (Classification)**: 预测一个**定性 (qualitative)** 或 **分类 (categorical)** 响应变量的过程。
- **目标**: 构建一个**分类器 (classifier)**，根据预测变量将观测值分配到预定义的类别中。
- **主要方法**: 本章探讨逻辑回归, LDA, QDA, 朴素贝叶斯, 和 KNN。

### 为什么不能用线性回归？
- **多类别问题**: 将类别强制编码为数值 (如 1, 2, 3) 会引入不存在的顺序和等距关系，模型结果不可靠。
- **二元分类问题**: 即使使用 0/1 编码，线性回归的预测值也可能超出 [0, 1] 区间，无法解释为概率。

### 逻辑回归 (Logistic Regression)
- **核心思想**: 对样本属于某个类别的**概率**进行建模，而非直接对类别建模。
- **模型**: 使用 **逻辑函数 (Logistic Function)** 确保输出值在 (0, 1) 区间内。
  $$
  p(X) = \frac{e^{\beta_0 + \beta_1X}}{1 + e^{\beta_0 + \beta_1X}}
  $$
- **系数解释**:
  - 基于 **对数几率 (log-odds)** 进行解释。
  - 预测变量 X 每增加一个单位，对数几率会改变 $\beta_1$。
- **模型拟合**: 通常使用**最大似然法 (Maximum Likelihood)** 来估计系数。
- **多类别扩展**: 可扩展为**多项式逻辑回归 (Multinomial Logistic Regression)**。

### 生成式模型 (Generative Models)
- **基本原理**: 与逻辑回归直接对 $P(Y|X)$ 建模不同，生成式模型先对每个类别下 $X$ 的分布 $P(X|Y)$ 建模，然后通过**贝叶斯定理**计算后验概率 $P(Y|X)$。
  $$
  P(Y=k|X=x) = \frac{\pi_k f_k(x)}{\sum_{l=1}^{K}\pi_l f_l(x)}
  $$
- #### 1. 线性判别分析 (Linear Discriminant Analysis - LDA)
  - **核心假设**: 预测变量 X 在每个类别中都服从多元高斯分布，且所有类别**共享同一个协方差矩阵**。
  - **决策边界**: 线性。
- #### 2. 二次判别分析 (Quadratic Discriminant Analysis - QDA)
  - **核心假设**: 预测变量 X 在每个类别中都服从多元高斯分布，但**每个类别拥有各自的协方差矩阵**。
  - **决策边界**: 二次型。
  - **与LDA的权衡**: QDA 更灵活但需要更多数据，是典型的**偏倚-方差权衡 (bias-variance trade-off)**。
- #### 3. 朴素贝叶斯 (Naive Bayes)
  - **核心假设**: 在每个类别内部，所有预测变量**相互独立**。
  - **优势**: 极大地简化了模型，在预测变量 p 很多而样本量 n 不足时表现优异。

### 模型评估与比较
- **混淆矩阵 (Confusion Matrix)**: 展示预测类别与真实类别的对应关系，分析错误类型。
- **关键指标**:
  - **敏感性 (Sensitivity)**: 真阳性率。
  - **特异性 (Specificity)**: 真阴性率。
- **ROC 曲线与 AUC**:
  - **ROC 曲线**: 可视化分类器在所有阈值下的性能权衡。
  - **AUC (曲线下面积)**: 衡量分类器整体性能的指标，越接近1越好。

### 广义线性模型 (Generalized Linear Models - GLM)
- **概念**: 一个统一的框架，包含了线性回归、逻辑回归和泊松回归等模型。
- **组成**:
  1. 一个来自**指数分布族**的响应变量分布。
  2. 一个**连接函数 (Link Function)**，将响应变量的期望值与预测变量的线性组合联系起来。
- **泊松回归 (Poisson Regression)**: GLM 的一个特例，专门用于对**计数数据 (Count Data)** 建模。

### 实验总结
- **实践内容**: 使用 Python (`statsmodels`, `sklearn`) 应用本章介绍的各种分类方法。
- **关键步骤**:
  - **数据划分**: 将数据分为训练集和测试集以评估模型泛化能力。
  - **特征标准化**: 对 KNN 等基于距离的模型至关重要。
  - **模型评估**: 使用混淆矩阵等工具比较不同模型的性能。